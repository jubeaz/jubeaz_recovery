---
- import_playbook: playbooks/lab_data.yml
  vars:
    data_path: "/etc/ansible/lab_inventories/{{domain_name}}"
  tags: 'data'

#- import_playbook: playbooks/debug.yml

- import_playbook: playbooks/build-computers.yml
- import_playbook: playbooks/build-domains.yml
- import_playbook: playbooks/domain-members.yml
- import_playbook: playbooks/build-trusts.yml
#- import_playbook: playbooks/ad-data.yml
#- import_playbook: playbooks/gmsa.yml
#- import_playbook: playbooks/laps.yml
#- import_playbook: playbooks/adcs.yml
#- import_playbook: playbooks/ad-relations.yml
#- import_playbook: playbooks/ad-acl.yml
#- import_playbook: playbooks/iis.yml
#- import_playbook: playbooks/webdav.yml


#- import_playbook: playbooks/mssql.yml
## SECURITY -----
# --------------------------------------------------------------------
# specifics security linked to the scenario are here
#- import_playbook: playbooks/security.yml
# --------------------------------------------------------------------
# specifics vulns linked to the scenario are here
#- import_playbook: playbooks/vulnerabilities.yml

#- import_playbook: playbooks/reboot.yml
# ##################
#  TO CONTINUE
# ##################

#- name: finish servers
#  hosts: domain_server
#  roles:
#    - { role: 'windows_domain/install_features', tags: 'install_features'}
#    - { role: 'windows_domain/install_softwares', tags: 'install_softwares' }
#    #- { role: 'windows_domain/clone_repos', tags: 'repos'}
#    - { role: 'windows_domain/download_files', tags: 'download_files' }
#  vars:
#    hostname: "{{lab.hosts[dict_key].hostname}}"
#    domain: "{{lab.hosts[dict_key].domain}}"
#    features: "{{lab.hosts[dict_key].features}}"
#    softwares: "{{lab.hosts[dict_key].softwares}}"
#    repos: "{{lab.hosts[dict_key].repos}}"
#    download_files: "{{lab.hosts[dict_key].download_files}}"
#    domain_username: "{{domain}}\\Administrator"
#    domain_password: "{{lab.domains[domain].domain_password}}"
#    domain_server: "{{lab.hosts[dict_key].hostname}}.{{domain}}"